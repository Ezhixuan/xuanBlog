<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Ezhixuan</title>
  <icon>https://www.ezhixuan.xyz/icon/android-chrome-192x192.png</icon>
  <subtitle>我们都要努力成为更好的自己 | 如果遇到了，就记录下来</subtitle>
  <link href="https://www.ezhixuan.xyz/atom.xml" rel="self"/>
  
  <link href="https://www.ezhixuan.xyz/"/>
  <updated>2023-09-08T02:10:04.000Z</updated>
  <id>https://www.ezhixuan.xyz/</id>
  
  <author>
    <name>Ezhixuan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用腾讯云Cos实现上传下载</title>
    <link href="https://www.ezhixuan.xyz/post/e2534ec2/"/>
    <id>https://www.ezhixuan.xyz/post/e2534ec2/</id>
    <published>2023-09-08T02:10:04.000Z</published>
    <updated>2023-09-08T02:10:04.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><h4 id="本文中出现的所有xiaomotxcos-均可替换成任意自己填入"><a class="markdownIt-Anchor" href="#本文中出现的所有xiaomotxcos-均可替换成任意自己填入"></a> 本文中出现的所有xiaomo.txcos 均可替换成任意自己填入</h4></blockquote><h2 id="使用腾讯云cos实现上传下载"><a class="markdownIt-Anchor" href="#使用腾讯云cos实现上传下载"></a> 使用腾讯云cos实现上传下载</h2><h3 id="导入依赖"><a class="markdownIt-Anchor" href="#导入依赖"></a> 导入依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.qcloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cos_api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.6.167<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="设置上传文件大小"><a class="markdownIt-Anchor" href="#设置上传文件大小"></a> 设置上传文件大小</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">servlet:</span></span><br><span class="line">  <span class="attr">multipart:</span></span><br><span class="line">    <span class="attr">max-request-size:</span> <span class="string">1024MB</span></span><br><span class="line">    <span class="attr">max-file-size:</span> <span class="string">1024MB</span> </span><br></pre></td></tr></table></figure><h3 id="配置文件通过配置文件填入对应数值"><a class="markdownIt-Anchor" href="#配置文件通过配置文件填入对应数值"></a> 配置文件，通过配置文件填入对应数值。</h3><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">xiaomo:</span></span><br><span class="line">  <span class="attr">txcos:</span></span><br><span class="line">    <span class="attr">tmpSecretId:</span> <span class="comment"># 你的secretId</span></span><br><span class="line">    <span class="attr">tmpSecretKey:</span> <span class="comment"># 你的secretKey</span></span><br><span class="line">    <span class="attr">bucketName:</span> <span class="comment"># 你的bucketName</span></span><br><span class="line">    <span class="attr">region:</span> <span class="comment"># 你仓库的地址</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: xiaomo-take-out</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: 腾讯云Cos</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: Mr.Xuan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2023-09-08 10:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;xiaomo.txcos&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TencentCosProperties</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String tmpSecretId;</span><br><span class="line">  <span class="keyword">private</span> String tmpSecretKey;</span><br><span class="line">  <span class="keyword">private</span> String bucketName;</span><br><span class="line">  <span class="keyword">private</span> String region;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="通过ioc初始化bean"><a class="markdownIt-Anchor" href="#通过ioc初始化bean"></a> 通过IOC初始化Bean</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: xiaomo-take-out</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: Mr.Xuan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2023-09-08 10:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CosConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Bean</span></span><br><span class="line">  <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">  <span class="keyword">public</span> TencentCosUtil <span class="title function_">tencentCosUtil</span><span class="params">(TencentCosProperties tencentCosProperties)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;开始创建腾讯云文件上传对象&#123;&#125;&quot;</span>, tencentCosProperties);</span><br><span class="line">    <span class="type">TencentCosUtil</span> <span class="variable">tencentCosUtil</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TencentCosUtil</span>(</span><br><span class="line">            tencentCosProperties.getTmpSecretId(),</span><br><span class="line">            tencentCosProperties.getTmpSecretKey(),</span><br><span class="line">            tencentCosProperties.getBucketName(),</span><br><span class="line">            tencentCosProperties.getRegion());</span><br><span class="line">    <span class="keyword">return</span> tencentCosUtil;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="导入上传工具类"><a class="markdownIt-Anchor" href="#导入上传工具类"></a> 导入上传工具类</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: xiaomo-take-out</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: cos工具类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: Mr.Xuan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2023-09-08 11:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TencentCosUtil</span> &#123;</span><br><span class="line">  <span class="keyword">private</span> String tmpSecretId;</span><br><span class="line">  <span class="keyword">private</span> String tmpSecretKey;</span><br><span class="line">  <span class="keyword">private</span> String bucketName;</span><br><span class="line">  <span class="keyword">private</span> String region;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">    <span class="comment">// 创建COSClient实例</span></span><br><span class="line">    <span class="type">ClientConfig</span> <span class="variable">clientConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ClientConfig</span>(<span class="keyword">new</span> <span class="title class_">Region</span>(region));</span><br><span class="line">    clientConfig.setHttpProtocol(HttpProtocol.https);</span><br><span class="line">    <span class="type">COSClient</span> <span class="variable">cosClient</span> <span class="operator">=</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">COSClient</span>(<span class="keyword">new</span> <span class="title class_">BasicCOSCredentials</span>(tmpSecretId, tmpSecretKey), clientConfig);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// 获取上传文件的输入流</span></span><br><span class="line">      <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> file.getInputStream();</span><br><span class="line">      <span class="comment">// 对象键(Key)是对象在存储桶中的唯一标识。</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">substring</span> <span class="operator">=</span></span><br><span class="line">          Objects.requireNonNull(file.getOriginalFilename())</span><br><span class="line">              .substring(file.getOriginalFilename().lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">      <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> UUID.randomUUID().toString().replaceAll(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) + substring;</span><br><span class="line">      <span class="comment">// 对上传文件分组</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">dateUrl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DateTime</span>().toString(<span class="string">&quot;yyyy/MM/dd&quot;</span>);</span><br><span class="line">      key = dateUrl + <span class="string">&quot;/&quot;</span> + key;</span><br><span class="line"></span><br><span class="line">      <span class="type">ObjectMetadata</span> <span class="variable">objectMetadata</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMetadata</span>();</span><br><span class="line"></span><br><span class="line">      <span class="type">PutObjectRequest</span> <span class="variable">putObjectRequest</span> <span class="operator">=</span></span><br><span class="line">          <span class="keyword">new</span> <span class="title class_">PutObjectRequest</span>(bucketName, key, inputStream, objectMetadata);</span><br><span class="line">      <span class="type">PutObjectResult</span> <span class="variable">putObjectResult</span> <span class="operator">=</span> cosClient.putObject(putObjectRequest);</span><br><span class="line">      System.out.println(JSON.toJSONString(putObjectResult));</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 返回上传文件路径</span></span><br><span class="line">      <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;https://&quot;</span>);</span><br><span class="line">      stringBuilder</span><br><span class="line">          .append(bucketName)</span><br><span class="line">          .append(<span class="string">&quot;.cos.&quot;</span>)</span><br><span class="line">          .append(region)</span><br><span class="line">          .append(<span class="string">&quot;.myqcloud.com/&quot;</span>)</span><br><span class="line">          .append(key);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="最后到需要使用的地方自动装配工具类使用即可"><a class="markdownIt-Anchor" href="#最后到需要使用的地方自动装配工具类使用即可"></a> 最后到需要使用的地方自动装配工具类使用即可</h3><p>这里以Impl为例</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@program</span>: xiaomo-take-out</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>:</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: Mr.Xuan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span>: 2023-09-08 11:38</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">CommonService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TencentCosUtil tencentCosUtil;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件上传</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">upload</span> <span class="operator">=</span> tencentCosUtil.upload(file);</span><br><span class="line">        <span class="keyword">return</span> Result.success(upload);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">使用腾讯云cos实现上传下载</summary>
    
    
    
    <category term="java" scheme="https://www.ezhixuan.xyz/categories/java/"/>
    
    
    <category term="java" scheme="https://www.ezhixuan.xyz/tags/java/"/>
    
    <category term="腾讯云" scheme="https://www.ezhixuan.xyz/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
    <category term="cos" scheme="https://www.ezhixuan.xyz/tags/cos/"/>
    
  </entry>
  
  <entry>
    <title>公共字段自动填充</title>
    <link href="https://www.ezhixuan.xyz/post/781a6a1a/"/>
    <id>https://www.ezhixuan.xyz/post/781a6a1a/</id>
    <published>2023-09-07T13:27:04.000Z</published>
    <updated>2023-09-07T13:27:04.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="使用mp实现公共字段自动填充"><a class="markdownIt-Anchor" href="#使用mp实现公共字段自动填充"></a> 使用Mp实现公共字段自动填充</h2><ol><li>需要实现自动填充的字段上<strong>添加@TableFile标签</strong>，指定自动填充策略。</li><li><strong>实现MetaObjectHandler接口</strong></li></ol><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 创建时间 */</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 更新时间 */</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line"><span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 创建人 */</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line"><span class="keyword">private</span> Long createUser;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 修改人 */</span></span><br><span class="line"><span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line"><span class="keyword">private</span> Long updateUser;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MpHandler</span> <span class="keyword">implements</span> <span class="title class_">MetaObjectHandler</span> &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 插入元对象字段填充（用于插入时对公共字段的填充）</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> metaObject 元对象</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insertFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;开始插入填充&quot;</span>);</span><br><span class="line">    metaObject.setValue(<span class="string">&quot;createUser&quot;</span>, BaseContext.getCurrentId());</span><br><span class="line">    metaObject.setValue(<span class="string">&quot;createTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">    metaObject.setValue(<span class="string">&quot;updateUser&quot;</span>, BaseContext.getCurrentId());</span><br><span class="line">    metaObject.setValue(<span class="string">&quot;updateTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 更新元对象字段填充（用于更新时对公共字段的填充）</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> metaObject 元对象</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateFill</span><span class="params">(MetaObject metaObject)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;开始更新填充&quot;</span>);</span><br><span class="line">    metaObject.setValue(<span class="string">&quot;updateUser&quot;</span>, BaseContext.getCurrentId());</span><br><span class="line">    metaObject.setValue(<span class="string">&quot;updateTime&quot;</span>, LocalDateTime.now());</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此处BaseContext是由ThreadLocal获取。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 字段填充策略枚举类</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 判断注入的 insert 和 update 的 sql 脚本是否在对应情况下忽略掉字段的 if 标签生成</span></span><br><span class="line"><span class="comment"> * &lt;if test=&quot;...&quot;&gt;......&lt;/if&gt;</span></span><br><span class="line"><span class="comment"> * 判断优先级比 &#123;<span class="doctag">@link</span> FieldStrategy&#125; 高</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> hubin</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2017-06-27</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">FieldFill</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 默认不处理</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    DEFAULT,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入时填充字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    INSERT,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新时填充字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    UPDATE,</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 插入和更新时填充字段</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    INSERT_UPDATE</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">公共字段自动填充</summary>
    
    
    
    <category term="java" scheme="https://www.ezhixuan.xyz/categories/java/"/>
    
    
    <category term="java" scheme="https://www.ezhixuan.xyz/tags/java/"/>
    
    <category term="学习分享" scheme="https://www.ezhixuan.xyz/tags/%E5%AD%A6%E4%B9%A0%E5%88%86%E4%BA%AB/"/>
    
  </entry>
  
  <entry>
    <title>Hexo添加字数统计</title>
    <link href="https://www.ezhixuan.xyz/post/5904fa7e/"/>
    <id>https://www.ezhixuan.xyz/post/5904fa7e/</id>
    <published>2023-09-07T07:00:14.000Z</published>
    <updated>2023-09-07T07:00:14.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><h1 id="本篇文章使用的是hexo-stellar主题"><a class="markdownIt-Anchor" href="#本篇文章使用的是hexo-stellar主题"></a> 本篇文章使用的是hexo-stellar主题</h1></blockquote><h2 id="footerejs"><a class="markdownIt-Anchor" href="#footerejs"></a> footer.ejs</h2><p>首先找到<strong>node_modules/hexo-theme-stellar/layout/_partial/main/footer.ejs</strong>文件</p><p>末尾可直接复制整个footer.ejs文件</p><p>找到该代码所处区域</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">// footer</span><br><span class="line">  el += &#x27;&lt;div class=&quot;text&quot;&gt;&#x27;;</span><br><span class="line">  if (content) &#123;</span><br><span class="line">    if ((typeof content == &#x27;string&#x27;) &amp;&amp; content.constructor == String) &#123;</span><br><span class="line">      el += markdown(content);</span><br><span class="line">    &#125; else if ((typeof content == &#x27;object&#x27;) &amp;&amp; content.constructor == Array) &#123;</span><br><span class="line">      content.forEach((item, i) =&gt; &#123;</span><br><span class="line">        el += markdown(item);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>在其尾部添加代码</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">if (theme.footer.up_time) &#123;</span><br><span class="line">      el += &#x27;&lt;div&gt;&lt;span id=&quot;timeDate&quot;&gt;载入天数...&lt;/span&gt;&lt;span id=&quot;times&quot;&gt;载入时分秒...&lt;/span&gt;&#x27;;</span><br><span class="line">       if (theme.footer.busuanzi.enable) &#123;</span><br><span class="line">         el += &#x27;，&lt;span id=&quot;busuanzi_container_site_pv&quot;&gt;总访问量: &lt;span id=&quot;busuanzi_value_site_pv&quot;&gt;&lt;/span&gt;次&lt;/span&gt;&#x27;;</span><br><span class="line">         el += &#x27;，&lt;span id=&quot;busuanzi_container_site_uv&quot;&gt;访客数: &lt;span id=&quot;busuanzi_value_site_uv&quot;&gt;&lt;/span&gt;人&lt;/span&gt;&#x27;;</span><br><span class="line">       &#125;</span><br><span class="line">      el += &#x27;&lt;/div&gt;&#x27;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>最后在最底部添加代码</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script <span class="keyword">async</span> src=<span class="string">&quot;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">function</span> <span class="title function_">createtime</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">var</span> grt= <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&quot;09/01/2023 00:00:00&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    now.<span class="title function_">setTime</span>(now.<span class="title function_">getTime</span>()+<span class="number">250</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    days = (now - grt ) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> / <span class="number">24</span>; dnum = <span class="title class_">Math</span>.<span class="title function_">floor</span>(days);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    hours = (now - grt ) / <span class="number">1000</span> / <span class="number">60</span> / <span class="number">60</span> - (<span class="number">24</span> * dnum); hnum = <span class="title class_">Math</span>.<span class="title function_">floor</span>(hours);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span>(<span class="title class_">String</span>(hnum).<span class="property">length</span> ==<span class="number">1</span> )&#123;hnum = <span class="string">&quot;0&quot;</span> + hnum;&#125; minutes = (now - grt ) / <span class="number">1000</span> /<span class="number">60</span> - (<span class="number">24</span> * <span class="number">60</span> * dnum) - (<span class="number">60</span> * hnum);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    mnum = <span class="title class_">Math</span>.<span class="title function_">floor</span>(minutes); <span class="keyword">if</span>(<span class="title class_">String</span>(mnum).<span class="property">length</span> ==<span class="number">1</span> )&#123;mnum = <span class="string">&quot;0&quot;</span> + mnum;&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    seconds = (now - grt ) / <span class="number">1000</span> - (<span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * dnum) - (<span class="number">60</span> * <span class="number">60</span> * hnum) - (<span class="number">60</span> * mnum);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    snum = <span class="title class_">Math</span>.<span class="title function_">round</span>(seconds); <span class="keyword">if</span>(<span class="title class_">String</span>(snum).<span class="property">length</span> ==<span class="number">1</span> )&#123;snum = <span class="string">&quot;0&quot;</span> + snum;&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;timeDate&quot;</span>).<span class="property">innerHTML</span> = <span class="string">&quot;本站已运行 &quot;</span>+dnum+<span class="string">&quot; 天 &quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;times&quot;</span>).<span class="property">innerHTML</span> = hnum + <span class="string">&quot; 小时 &quot;</span> + mnum + <span class="string">&quot; 分 &quot;</span> + snum + <span class="string">&quot; 秒&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="built_in">setInterval</span>(<span class="string">&quot;createtime()&quot;</span>,<span class="number">250</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="最终代码"><a class="markdownIt-Anchor" href="#最终代码"></a> 最终代码</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">const content = theme.footer.content;</span><br><span class="line">function layoutDiv() &#123;</span><br><span class="line">  var el = &#x27;&#x27;;</span><br><span class="line">  el += &#x27;&lt;footer class=&quot;page-footer reveal fs12&quot;&gt;&#x27;;</span><br><span class="line">  el += &#x27;&lt;hr&gt;&#x27;;</span><br><span class="line">  // sitemap</span><br><span class="line">  if (theme.footer.sitemap &amp;&amp; Object.keys(theme.footer.sitemap).length &gt; 0) &#123;</span><br><span class="line">    el += &#x27;&lt;div class=&quot;sitemap&quot;&gt;&#x27;;</span><br><span class="line">    for (let group of Object.keys(theme.footer.sitemap)) &#123;</span><br><span class="line">      let items = theme.footer.sitemap[group];</span><br><span class="line">      if (items == undefined || items.length == 0) &#123;</span><br><span class="line">        continue;</span><br><span class="line">      &#125;</span><br><span class="line">      el += &#x27;&lt;div class=&quot;sitemap-group&quot;&gt;&#x27;;</span><br><span class="line">      el += &#x27;&lt;span class=&quot;fs14&quot;&gt;&#x27; + group + &#x27;&lt;/span&gt;&#x27;;</span><br><span class="line">      items.forEach((item, i) =&gt; &#123;</span><br><span class="line">        el += &#x27;&lt;a href=&quot;&#x27; + url_for(md_link(item)) + &#x27;&quot;&gt;&#x27;;</span><br><span class="line">        el += __(md_text(item));</span><br><span class="line">        el += &#x27;&lt;/a&gt;&#x27;;</span><br><span class="line">      &#125;);</span><br><span class="line">      el += &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    el += &#x27;&lt;/div&gt;&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line">  // footer</span><br><span class="line">  el += &#x27;&lt;div class=&quot;text&quot;&gt;&#x27;;</span><br><span class="line">  if (content) &#123;</span><br><span class="line">    if ((typeof content == &#x27;string&#x27;) &amp;&amp; content.constructor == String) &#123;</span><br><span class="line">      el += markdown(content);</span><br><span class="line">    &#125; else if ((typeof content == &#x27;object&#x27;) &amp;&amp; content.constructor == Array) &#123;</span><br><span class="line">      content.forEach((item, i) =&gt; &#123;</span><br><span class="line">        el += markdown(item);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  if (theme.footer.up_time) &#123;</span><br><span class="line">      el += &#x27;&lt;div&gt;&lt;span id=&quot;timeDate&quot;&gt;载入天数...&lt;/span&gt;&lt;span id=&quot;times&quot;&gt;载入时分秒...&lt;/span&gt;&#x27;;</span><br><span class="line">       if (theme.footer.busuanzi.enable) &#123;</span><br><span class="line">         el += &#x27;，&lt;span id=&quot;busuanzi_container_site_pv&quot;&gt;总访问量: &lt;span id=&quot;busuanzi_value_site_pv&quot;&gt;&lt;/span&gt;次&lt;/span&gt;&#x27;;</span><br><span class="line">         el += &#x27;，&lt;span id=&quot;busuanzi_container_site_uv&quot;&gt;访客数: &lt;span id=&quot;busuanzi_value_site_uv&quot;&gt;&lt;/span&gt;人&lt;/span&gt;&#x27;;</span><br><span class="line">       &#125;</span><br><span class="line">      el += &#x27;&lt;/div&gt;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">  el += &#x27;&lt;/div&gt;&lt;/footer&gt;&#x27;;</span><br><span class="line">  return el;</span><br><span class="line">&#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%- layoutDiv() %&gt;</span><br><span class="line"></span><br><span class="line">&lt;script async src=&quot;//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  function createtime() &#123;</span><br><span class="line">    var now = new Date();</span><br><span class="line">    var grt= new Date(&quot;09/01/2023 00:00:00&quot;);</span><br><span class="line">    now.setTime(now.getTime()+250);</span><br><span class="line">    days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);</span><br><span class="line">    hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);</span><br><span class="line">    if(String(hnum).length ==1 )&#123;hnum = &quot;0&quot; + hnum;&#125; minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);</span><br><span class="line">    mnum = Math.floor(minutes); if(String(mnum).length ==1 )&#123;mnum = &quot;0&quot; + mnum;&#125;</span><br><span class="line">    seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);</span><br><span class="line">    snum = Math.round(seconds); if(String(snum).length ==1 )&#123;snum = &quot;0&quot; + snum;&#125;</span><br><span class="line">    document.getElementById(&quot;timeDate&quot;).innerHTML = &quot;本站已运行 &quot;+dnum+&quot; 天 &quot;;</span><br><span class="line">    document.getElementById(&quot;times&quot;).innerHTML = hnum + &quot; 小时 &quot; + mnum + &quot; 分 &quot; + snum + &quot; 秒&quot;;</span><br><span class="line">  &#125;;</span><br><span class="line">  setInterval(&quot;createtime()&quot;,250);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="_configyml"><a class="markdownIt-Anchor" href="#_configyml"></a> _config.yml</h2><p>在主题目录（不是根目录）</p><p><strong>node_modules/hexo-theme-stellar/_config.yml</strong>添加如下配置即可</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">######## Footer ########</span><br><span class="line">footer:</span><br><span class="line">  ...</span><br><span class="line">  up_time:</span><br><span class="line">    enable: true</span><br><span class="line">  busuanzi:</span><br><span class="line">    enable: true</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">主题美化</summary>
    
    
    
    <category term="hexo" scheme="https://www.ezhixuan.xyz/categories/hexo/"/>
    
    
    <category term="hexo" scheme="https://www.ezhixuan.xyz/tags/hexo/"/>
    
  </entry>
  
</feed>
